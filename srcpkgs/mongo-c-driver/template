# Template file for 'mongo-c-driver'
pkgname=mongo-c-driver
version=2.1.0
revision=2
build_style=cmake
configure_args="-DENABLE_TESTS=OFF"
hostmakedepends="pkg-config"
makedepends="openssl-devel"
short_desc="High-performance MongoDB driver for C"
maintainer="Andrew Benson <abenson+void@gmail.com>"
license="Apache-2.0"
homepage="https://mongoc.org"
distfiles="https://github.com/mongodb/mongo-c-driver/archive/${version}.tar.gz"
checksum=dfa8db7750a7b4a49c840c1319dbdf7f3b7b4583003139927de37e71b5ae043a

pre_configure() {
	echo "${version}" > VERSION_CURRENT
}

mongo-c-driver-devel_package() {
	short_desc+=" - development files"
	depends="${sourcepkg}>=${version}_${revision}"
	pkg_install() {
		vmove usr/bin
		vmove "usr/include/mongoc*"
		vmove "usr/lib/cmake/*mongoc*"
		vmove "usr/lib/pkgconfig/mongoc*"
		vmove "usr/lib/libmongoc*.so"
		vmove "usr/lib/libmongoc*.a"
	}
}

libbson_package() {
	short_desc="Cross Platform BSON Library for C"
	pkg_install() {
		vmove "usr/lib/libbson*.so.*"
	}
}

libbson-devel_package() {
	short_desc="Cross Platform BSON Library for C - development files"
	depends="libbson>=${version}_${revision}"
	pkg_install() {
		vmove "usr/include/bson*"
		vmove "usr/lib/cmake/*bson*"
		vmove "usr/lib/pkgconfig/bson*"
		vmove "usr/lib/libbson*.so"
		vmove "usr/lib/libbson*.a"
	}
}
